# Ufebs-N

![badge](https://github.com/diev/Ufebs-N/actions/workflows/dotnet8-desktop.yml/badge.svg)

Нормализация XML и установка ЗК/КА в документы УФЭБС.

![Рабочее окно приложения](docs/assets/images/ToKBR-Forms.png)

## Settings / Настройки программы

В файле `ToKBR-Forms.runtimeconfig.json` секция `configProperties`:

* `"IN.Dir": "."` - 
папка для исходных файлов `*.xml`, получаемых извне;
* `"ZK.Dir": "1ZK"` - 
папка результатов Операциониста - с установленным ЗК
(эти файлы и в Backup идут);
* `"KA.Dir": "2KA"` - 
папка результатов Контролера - с установленным КА
(эти файлы и отправляются в КБР);
* `"KBR.Dir": "3Out"` - 
папка для автоматической отправки в КБР-Н
(папка `X:\\Cli` - КБР оттуда удалит!);
* `"Backup.Dir": "Backup"` - 
папка для накопления прошедших файлов (исходные файлы с установленным ЗК);
* `"Temp.Dir": "Temp"` - 
папка для промежуточных файлов (нормализованные xml, двоичные подписи p7d);
* `"File.Delete": true|false` - 
удалять ли все исходные и промежуточные файлы
(входная папка очищается также! остаются только в папках Backup и KBR);
* `"Step.1": "*"` - 
массив допущенных пользователей/компьютеров к операциям шага 1
(* - все);
* `"Step.2": "*"` - 
массив допущенных пользователей/компьютеров к операциям шага 2
(* - все);
* `"Step.3": "*"` - 
массив допущенных пользователей/компьютеров к операциям шага 3
(* - все);
* `"//SpkiUtl.Exe": "C:\\Program Files\\MDPREI\\spki\\spki1utl.exe"` - 
путь к утилите СКАД "Сигнатура" -
раскомментировать в рабочей среде;
* `"//SpkiUtl.SignDetached": "-sign -data {0} -out {1} -detached"` - 
командная строка утилиты (подписывание файла с отсоединенной подписью,
с указанием исходного `{0}` и результирующего файла `{1}`) -
раскомментировать в рабочей среде;
* `"SpkiUtl.Exe": "C:\\Windows\\System32\\cmd.exe"` - 
для проведения тестов без установленной СКАД "Сигнатура";
* `"SpkiUtl.SignDetached": "/c copy {0} {1}"` - 
для проведения тестов без установленной СКАД "Сигнатура".

## CLI / Утилита командной строки

    tokbr 1 file.xml
    tokbr 2 file.zk.xml
    tokbr 3 file.zk.ka.xml

## Requirements / Требования

- .NET 8 Desktop Runtime

## License / Лицензия

Licensed under the [Apache License, Version 2.0].

[Apache License, Version 2.0]: LICENSE
